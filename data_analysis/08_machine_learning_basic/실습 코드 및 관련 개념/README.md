# ì‹¤ìŠµ ê´€ë ¨ ê°œë… ì •ë¦¬
## ğŸ”¹ One-Hot Encoding
âš¡ **One-Hot Encoding**ì€ ë²”ì£¼í˜• ë°ì´í„°ë¥¼ ìˆ«ìë¡œ ë³€í™˜í•  ë•Œ ìì£¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ

âš¡ íŠ¹ì • ë²”ì£¼(category)ì— í•´ë‹¹í•˜ë©´ `1`, ì•„ë‹ˆë©´ `0`ì„ ë¶€ì—¬í•˜ì—¬
ëª¨ë¸ì´ ê° ë²”ì£¼ë¥¼ ë…ë¦½ëœ íŠ¹ì§•ìœ¼ë¡œ ì¸ì‹í•˜ë„ë¡ ë§Œë“¤ì–´ì¤Œ

### ì˜ˆì‹œ: ë‚ ì§œ One-Hot Encoding
| Day of Week | Day_0 | Day_1 | Day_2 | Day_3 | Day_4 | Day_5 | Day_6 |
| ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 0 (ì›”)       | 1     | 0     | 0     | 0     | 0     | 0     | 0     |
| 3 (ëª©)       | 0     | 0     | 0     | 1     | 0     | 0     | 0     |
| 6 (ì¼)       | 0     | 0     | 0     | 0     | 0     | 0     | 1     |

### ìˆ˜ë™ êµ¬í˜„ (`apply` + `lambda`)
```python
# "Day of Week" ì»¬ëŸ¼ì— 0~6 (ì›”~ì¼)ì´ ë“¤ì–´ ìˆë‹¤ê³  ê°€ì •
# ê° ìš”ì¼ì— ëŒ€í•´ ìƒˆë¡œìš´ ì»¬ëŸ¼ ìƒì„±
for i in range(7):
    data[f'Day_{i}'] = data['Day of Week'].apply(lambda x: 1 if x == i else 0)
```
- `lambda x` : í–‰ë§ˆë‹¤ Day of Week ê°’ì„ ë°›ì•„ì˜´
- `1 if x == i else 0` : í•´ë‹¹ ìš”ì¼ì´ë©´ 1, ì•„ë‹ˆë©´ 0
- `.apply()` : ê° í–‰ì— í•¨ìˆ˜ë¥¼ ì ìš©í•˜ì—¬ ìƒˆë¡œìš´ ì»¬ëŸ¼ ìƒì„±
- ëŒë‹¤ì‹ êµ¬ì¡° ë¶„ì„
  ```python
  # ì¼ë°˜ í•¨ìˆ˜ ë²„ì „
  def f(x):
      return 1 if x == i else 0

  # ëŒë‹¤ ë²„ì „
  # lambda x: -> ì´ë¦„ ì—†ëŠ” í•¨ìˆ˜ì¸ë°, ì…ë ¥ê°’ì´ 'x'
  lambda x: 1 if x == i else 0
  ```

### ìë™ êµ¬í˜„ (`pd.get_dummies()`)
```python
import pandas as pd

data = pd.DataFrame({
    'Day of Week': [0, 3, 6]
})

encoded = pd.get_dummies(data, columns=['Day of Week'], prefix='Day')
print(encoded)
```
- `pd.get_dummies()`
  - **ë²”ì£¼í˜• ë°ì´í„°(categorical data)** ë¥¼
ëª¨ë¸ì´ í•™ìŠµí•  ìˆ˜ ìˆëŠ” **ì´ì§„(0/1) í˜•íƒœ**ë¡œ ìë™ ë³€í™˜í•´ì£¼ëŠ” í•¨ìˆ˜
  - ì¦‰, One-Hot Encodingì„ ì†ì‰½ê²Œ êµ¬í˜„ ê°€ëŠ¥
  - ì£¼ìš” íŒŒë¼ë¯¸í„°
    | ì˜µì…˜             | ê¸°ë³¸ê°’        | ì„¤ëª…                         |
    | -------------- | ---------- | -------------------------- |
    | **data**       | (í•„ìˆ˜)       | ë³€í™˜í•  ë°ì´í„°í”„ë ˆì„                 |
    | **columns**    | `None`     | ì¸ì½”ë”©í•  ì»¬ëŸ¼ ì§€ì • (ì—¬ëŸ¬ ê°œ ê°€ëŠ¥)       |
    | **prefix**     | `None`     | ìƒì„±ë˜ëŠ” ì»¬ëŸ¼ ì´ë¦„ ì•ì— ë¶™ì¼ ì ‘ë‘ì‚¬       |
    | **drop_first** | `False`    | ì²« ë²ˆì§¸ ë”ë¯¸ ì»¬ëŸ¼ì„ ì œê±° (ë‹¤ì¤‘ê³µì„ ì„± ë°©ì§€ìš©) |
    | **dtype**      | `np.uint8` | ìƒì„±ëœ ë”ë¯¸ ì»¬ëŸ¼ì˜ ë°ì´í„° íƒ€ì…          |


## ğŸ”¹ Label Encoding
âš¡ **Label Encoding**ì€ **ë¬¸ìì—´(ë²”ì£¼í˜• ë°ì´í„°)ì„ ì •ìˆ˜í˜• ìˆ«ì**ë¡œ ë³€í™˜í•˜ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ ì¸ì½”ë”© ë°©ì‹

âš¡ ê° ê³ ìœ í•œ ë¬¸ìì—´ ê°’ì— ëŒ€í•´ í•˜ë‚˜ì˜ ê³ ìœ í•œ ì •ìˆ˜ ë¼ë²¨ì„ ë¶€ì—¬í•¨

### ğŸ” ê°œë…
| ë¬¸ìì—´ ê°’ | ì •ìˆ˜ ë¼ë²¨ |
| ----- | ----- |
| A     | 0     |
| B     | 1     |
| C     | 2     |
- ì˜ˆë¥¼ ë“¤ì–´, `['A', 'C', 'B', 'A']`ë¼ëŠ” ì»¬ëŸ¼ì´ ìˆë‹¤ë©´
- Label Encoding ê²°ê³¼ëŠ” `[0, 2, 1, 0]`

### ì½”ë“œ êµ¬í˜„
```python
from sklearn.preprocessing import LabelEncoder

# LabelEncoder ê°ì²´ ìƒì„±
encoder = LabelEncoder()

# ì¸ì½”ë”© ëŒ€ìƒ ë°ì´í„°
colors = ['Red', 'Green', 'Blue', 'Green']

# ë³€í™˜ ìˆ˜í–‰
encoded = encoder.fit_transform(colors)

print("ì¸ì½”ë”© ê²°ê³¼:", encoded)
print("í´ë˜ìŠ¤ ëª©ë¡:", encoder.classes_)

```
- LabelEncoder
  - Scikit-learnì—ì„œ ì œê³µí•˜ëŠ” ì¸ì½”ë”ë¡œ,
ë¬¸ìì—´(ë˜ëŠ” ë²”ì£¼í˜• ë°ì´í„°)ì„ ì •ìˆ˜í˜• ìˆ«ì(Label) ë¡œ ë³€í™˜í•¨
  - ê° ê³ ìœ í•œ í´ë˜ìŠ¤ ê°’ì„ 0ë¶€í„° ì‹œì‘í•˜ëŠ” ì •ìˆ˜ë¡œ ë§¤í•‘í•˜ëŠ” ì—­í• 
  - ì£¼ìš” ë©”ì„œë“œ
    | ë©”ì„œë“œ                    | ì„¤ëª…                          | ì˜ˆì‹œ                         |
    | ---------------------- | --------------------------- | -------------------------- |
    | `fit(y)`               | ë°ì´í„°ì˜ ê³ ìœ ê°’ì„ í•™ìŠµí•˜ì—¬ ë‚´ë¶€ ë§¤í•‘ í…Œì´ë¸” ìƒì„± | `'Red' â†’ 2`, `'Blue' â†’ 0`  |
    | `transform(y)`         | í•™ìŠµëœ ë§¤í•‘ ê¸°ì¤€ìœ¼ë¡œ ì‹¤ì œ ë°ì´í„° ë³€í™˜       | `'Green' â†’ 1`              |
    | `fit_transform(y)`     | `fit` + `transform` ë™ì‹œì— ìˆ˜í–‰  |                            |
    | `inverse_transform(y)` | ìˆ«ìë¥¼ ë‹¤ì‹œ ì›ë˜ ë¬¸ìì—´ë¡œ ë³µì›           | `[2, 0] â†’ ['Red', 'Blue']` |
    | `classes_`             | í•™ìŠµëœ ê³ ìœ  í´ë˜ìŠ¤ ëª©ë¡ í™•ì¸            | `['Blue', 'Green', 'Red']` |
  - âš ï¸ ì£¼ì˜ì 
    - LabelEncoderëŠ” **1ì°¨ì› ë°ì´í„°ë§Œ ì²˜ë¦¬ ê°€ëŠ¥**
    - ì—¬ëŸ¬ ê°œì˜ ì»¬ëŸ¼(2D ë°ì´í„°)ì— ì‚¬ìš©í•˜ë ¤ë©´ ê°ê° ë”°ë¡œ ì¸ì½”ë”©í•´ì•¼ í•¨
      ```python
      data['col1'] = encoder.fit_transform(data['col1'])
      data['col2'] = encoder.fit_transform(data['col2'])
      ```

### âš ï¸ ì£¼ì˜ì‚¬í•­
Label Encodingì€ **ìˆ«ìì˜ í¬ê¸°ê°€ ì¸ìœ„ì ì¸ "ìˆœì„œ"ë¡œ ì¸ì‹**ë  ìˆ˜ ìˆìŒ

-> ì¦‰, A=0, B=1, C=2ì´ë©´
ëª¨ë¸ì´ **â€œCê°€ Bë³´ë‹¤ í¬ë‹¤â€**ì²˜ëŸ¼ ì˜ëª»ëœ ê´€ê³„ë¡œ í•´ì„í•  ìˆ˜ ìˆìŒ âŒ

-> ë”°ë¼ì„œ:
- **ìˆœì„œê°€ ì—†ëŠ” ë°ì´í„°(Nominal)** -> âŒ Label Encoding (ëŒ€ì‹  `One-Hot Encoding` ê¶Œì¥)
- **ìˆœì„œê°€ ìˆëŠ” ë°ì´í„°(Ordinal)** â†’ âœ… `Label Encoding` ì‚¬ìš©


## ğŸ”¹ ì´ìƒì¹˜ íƒì§€ (Outlier Detection)
âš¡ ì´ìƒì¹˜ëŠ” ë°ì´í„°ì˜ ì „ë°˜ì ì¸ ë¶„í¬ì—ì„œ ë²—ì–´ë‚œ ê·¹ë‹¨ì ì¸ ê°’ì„ ì˜ë¯¸

âš¡ ì´ìƒì¹˜ê°€ ì¡´ì¬í•˜ë©´ ëª¨ë¸ í•™ìŠµ ì‹œ ì™œê³¡ì´ ë°œìƒí•˜ê±°ë‚˜ ì˜ˆì¸¡ ì„±ëŠ¥ì´ ì €í•˜ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ
ë¶„ì„ ì „ì— ë°˜ë“œì‹œ íƒì§€ ë° ì²˜ë¦¬í•´ì•¼ í•¨

### IQR (Interquartile Range) ê¸°ë°˜ ì´ìƒì¹˜ íƒì§€
ë°ì´í„°ì˜ **ì‚¬ë¶„ìœ„ìˆ˜(Quartile)** ë¥¼ ì´ìš©í•´ ì´ìƒì¹˜ë¥¼ íŒë³„

-> ë°ì´í„°ì˜ ì¤‘ê°„ 50% êµ¬ê°„(Q1~Q3)ì„ ê¸°ì¤€ìœ¼ë¡œ, ì´ ë²”ìœ„ì—ì„œ ë„ˆë¬´ ë²—ì–´ë‚œ ê°’ì„ ì´ìƒì¹˜ë¡œ ê°„ì£¼í•¨

| êµ¬ë¶„                | ì˜ë¯¸             |
| ----------------- | -------------- |
| **Q1 (1ì‚¬ë¶„ìœ„ìˆ˜)**    | í•˜ìœ„ 25% ì§€ì ì˜ ê°’   |
| **Q3 (3ì‚¬ë¶„ìœ„ìˆ˜)**    | ìƒìœ„ 25% ì§€ì ì˜ ê°’   |
| **IQR (Q3 - Q1)** | ë°ì´í„°ì˜ ì¤‘ì•™ 50% ë²”ìœ„ |

- ì´ìƒì¹˜ íŒë‹¨ ê¸°ì¤€
  - $lower_bound=Q1âˆ’1.5Ã—IQR$
  - $upper_bound=Q3+1.5Ã—IQR$

- ì½”ë“œ ì˜ˆì‹œ
  ```python
  # 1. ì‚¬ë¶„ìœ„ìˆ˜ ê³„ì‚°
  Q1 = data['Speed (km/h)'].quantile(0.25)
  Q3 = data['Speed (km/h)'].quantile(0.75)
  IQR = Q3 - Q1

  # 2. ì´ìƒì¹˜ ê¸°ì¤€ì„  ì„¤ì •
  lower_bound = Q1 - 1.5 * IQR
  upper_bound = Q3 + 1.5 * IQR

  # 3. ì´ìƒì¹˜ íŒë³„
  data['IQR Outlier'] = (data['Speed (km/h)'] < lower_bound) | (data['Speed (km/h)'] > upper_bound)
  ```

- íŠ¹ì§•
  - ë¶„í¬ê°€ ë¹„ì •ê·œì¼ ë•Œë„ ì‚¬ìš© ê°€ëŠ¥
  - ê³„ì‚°ì´ ê°„ë‹¨í•˜ê³ , ê·¹ë‹¨ê°’ì— ëœ ë¯¼ê°í•¨
  - ë°ì´í„° ì–‘ì´ ì‘ìœ¼ë©´ ê²½ê³„ì„ ì´ ë¶ˆì•ˆì •í•´ì§
  - ë¹„ì •ê·œë¶„í¬, ì†Œê·œëª¨ ë°ì´í„°ì…‹ì— ì í•©í•¨

### Z-score ê¸°ë°˜ ì´ìƒì¹˜ íƒì§€
**Z-score**ëŠ” ê° ë°ì´í„°ê°€ í‰ê· ìœ¼ë¡œë¶€í„° ëª‡ í‘œì¤€í¸ì°¨(Ïƒ) ë–¨ì–´ì ¸ ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ëƒ„

-> ë°ì´í„°ê°€ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ê³  ê°€ì •í•  ë•Œ,
Z-scoreì˜ ì ˆëŒ“ê°’ì´ **3 ì´ìƒ**ì´ë©´ ì¼ë°˜ì ìœ¼ë¡œ ì´ìƒì¹˜ë¡œ ê°„ì£¼í•¨

-> $Z = \frac{x - \mu}{\sigma}$

| ê¸°í˜¸         | ì˜ë¯¸    |
| ---------- | ----- |
|  $x$      | ë°ì´í„° ê°’ |
|  $\mu$    | í‰ê·     |
|  $\sigma$ | í‘œì¤€í¸ì°¨  |

- ì½”ë“œ ì˜ˆì‹œ
  ```python
  from scipy import stats

  # 1. Z-score ê³„ì‚°
  data['Z-score'] = stats.zscore(data['Speed (km/h)'])

  # 2. Z-score ê¸°ì¤€ìœ¼ë¡œ ì´ìƒì¹˜ íŒë³„ (ì ˆëŒ“ê°’ì´ 3 ì´ˆê³¼)
  data['Z-score Outlier'] = (abs(data['Z-score']) > 3)
  ```

- íŠ¹ì§•
  - ì •ê·œë¶„í¬(ê°€ìš°ì‹œì•ˆ ë¶„í¬)ë¥¼ ê°€ì •
  - ì´ìƒì¹˜ì˜ "ì •ë„"ë¥¼ ìˆ˜ì¹˜ë¡œ í‘œí˜„ ê°€ëŠ¥
  - ì •ê·œë¶„í¬ê°€ ì•„ë‹ ê²½ìš° ë¶€ì •í™•í•¨
  - ëŒ€ê·œëª¨, ì •ê·œë¶„í¬ì— ê°€ê¹Œìš´ ë°ì´í„°ì…‹ì— ì í•©í•¨


## ğŸ”¹ íšŒê·€(Regression) ëª¨ë¸ ì„±ëŠ¥ í‰ê°€ ì§€í‘œ
âš¡ íšŒê·€ ëª¨ë¸ì€ **ì—°ì†ì ì¸ ê°’ì„ ì˜ˆì¸¡**í•˜ëŠ” ëª¨ë¸ë¡œ

âš¡ ì˜ˆì¸¡ê°’ê³¼ ì‹¤ì œê°’ì˜ ì°¨ì´ë¥¼ ìˆ˜ì¹˜ë¡œ í‰ê°€í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ì§€í‘œ(metric)ë¥¼ ì‚¬ìš©í•¨

|ì§€í‘œ | ìˆ˜ì‹| ì„¤ëª…| ì¢‹ì€ ëª¨ë¸ ê¸°ì¤€| 
| ---- | --- | --- | ------- |
| **MAE**<br>(Mean Absolute Error)             | $MAE = \frac{1}{n}\sum_{i=1}^{n} y_i - \hat{y}_i$  | ì ˆëŒ€ ì˜¤ì°¨ì˜ í‰ê· . ì´ìƒì¹˜ì— ë‘”ê°í•˜ë©° í•´ì„ì´ ì§ê´€ì  | 0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì¢‹ìŒ  |
| **MSE**<br>(Mean Squared Error) | $MSE = \frac{1}{n}\sum_{i=1}^{n}(y_i - \hat{y}_i)^2$  | ì œê³± ì˜¤ì°¨ì˜ í‰ê· . í° ì˜¤ì°¨ì— ë¯¼ê° | 0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì¢‹ìŒ |                              |              |
| **RMSE**<br>(Root Mean Squared Error)| $RMSE = \sqrt{\frac{1}{n}\sum_{i=1}^{n} (y_i - \hat{y}_i)^2}$ | MSEì˜ ì œê³±ê·¼. ì‹¤ì œ ë‹¨ìœ„ë¡œ í•´ì„ ê°€ëŠ¥ | 0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì¢‹ìŒ |                              |              |
| **RÂ² Score**<br>(ê²°ì •ê³„ìˆ˜) | $R^2 = 1 - \frac{\sum (y_i - \hat{y}_i)^2}{\sum (y_i - \bar{y})^2}$ | ëª¨ë¸ì˜ ì„¤ëª…ë ¥ (1ì´ë©´ ì™„ë²½, 0ì€ í‰ê·  ìˆ˜ì¤€) | 1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì¢‹ìŒ |                              |              |
| **MAPE**<br>(Mean Absolute Percentage Error) | $MAPE = (100/n) Î£ âˆ£yáµ¢ âˆ’ Å·áµ¢âˆ£ / âˆ£yáµ¢âˆ£$ | ìƒëŒ€ì  ì˜¤ì°¨ ë¹„ìœ¨(%)   | 0%ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì¢‹ìŒ |

- ì½”ë“œ ì‚¬ìš© ì˜ˆì‹œ
  ```python
  import numpy as np
  from sklearn.metrics import mean_absolute_error
  from sklearn.metrics import mean_squared_error
  from sklearn.metrics import r2_score 
  from scipy import stats

  # ì˜ˆì‹œ ë°ì´í„°
  y_true = np.array([3.0, -0.5, 2.0, 7.0])
  y_pred = np.array([2.5, 0.0, 2.1, 7.8])

  # MAE (í‰ê·  ì ˆëŒ€ ì˜¤ì°¨)
  mae = mean_absolute_error(y_true, y_pred)

  # MSE (í‰ê·  ì œê³± ì˜¤ì°¨)
  mse = mean_squared_error(y_true, y_pred)

  # RMSE (í‰ê·  ì œê³±ê·¼ ì˜¤ì°¨)
  rmse = np.sqrt(mse)

  # RÂ² Score (ê²°ì •ê³„ìˆ˜)
  r2 = r2_score(y_true, y_pred)

  # MAPE (í‰ê·  ì ˆëŒ€ ë°±ë¶„ìœ¨ ì˜¤ì°¨)
  mape = np.mean(np.abs((y_true - y_pred) / y_true)) * 100

  # ê²°ê³¼ ì¶œë ¥
  print("íšŒê·€ ëª¨ë¸ ì„±ëŠ¥ í‰ê°€ ì§€í‘œ ê²°ê³¼")
  print("--------------------------------")
  print(f"MAE  (Mean Absolute Error): {mae:.4f}")
  print(f"MSE  (Mean Squared Error): {mse:.4f}")
  print(f"RMSE (Root Mean Squared Error): {rmse:.4f}")
  print(f"RÂ²   (R-squared): {r2:.4f}")
  print(f"MAPE (Mean Absolute Percentage Error): {mape:.2f}%")
  ```

